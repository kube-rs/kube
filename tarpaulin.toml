# Usage: configure your kubernetes context and run cargo tarpaulin
# Runs integration tests (--ignored) plus --lib tests on main crates
#
# NB: cargo tarpaulin -- --test-threads 1 (can help diagnose test interdependencies)
# NB: Tests should complete in about 30-60s after the compile
# NB: full recompiles happen every time: https://github.com/xd009642/tarpaulin/issues/777 even with --skip-clean

[one_pass_coverage]
workspace = true
#features = "kube/derive kube/runtime kube/ws kube/jsonpatch kube/admission kube/gzip"
all-features = true
color = "Always"
ignored = true # integration tests
timeout = "600s"
exclude = ["e2e", "kube-derive"] # proc-macro code not picked up by tarpaulin
include-tests = true # include test coverage info to see what runs
# NB: skipping Doctests because they are slow to build and generally marked no_run
run-types = ["Tests"]

# We could potentially pass in examples here - but better to write integration tests in kube
#[example_pass]
#packages = ["kube-examples"]
#excluded_files = ["examples/"]
#workspace = true
#run-types = ["Tests"]
